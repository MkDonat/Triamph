//SPI setup pins
U8G2_SSD1309_128X64_NONAME2_1_4W_SW_SPI u8g2(
  U8G2_R0
  ,  
  18 // SLAVE CLOCK (SCK) ou (SCL)
  ,
  23 // SLAVE DATA (SDA)
  ,
  5 // CHEAP SELECT (CS)
  ,  
  2 // REGISTER SELECT (DC)
  ,
  4 // RESET (RES)
);
//Variables - Lopaka
static const unsigned char image_connected_bits[] = {0xe0,0x03,0x18,0x0c,0xe4,0x13,0x12,0x24,0xc9,0x49,0x25,0x52,0x95,0x54,0xc5,0x51,0x60,0x03,0xc0,0x01,0x80,0x00,0xc0,0x01,0x40,0x01,0x60,0x03,0x20,0x02,0x00,0x00};
static const unsigned char image_car_bits[] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x3f,0x00,0x40,0x64,0x00,0x20,0xc4,0x00,0xfe,0xff,0x03,0xed,0xbf,0x07,0xd7,0x5f,0x07,0xaa,0xaf,0x02,0x10,0x40,0x00};
static const unsigned char image_Battery_triamph_bits[] = {0xfe,0xff,0x7f,0x00,0x01,0x00,0x80,0x00,0x01,0x00,0x80,0x03,0x01,0x00,0x80,0x02,0x01,0x00,0x80,0x02,0x01,0x00,0x80,0x03,0x01,0x00,0x80,0x00,0xfe,0xff,0x7f,0x00};
static const unsigned char image_GameMode_bits[] = {0x20,0x00,0xfe,0x03,0xfb,0x07,0x71,0x05,0xfb,0x07,0x8f,0x07,0x07,0x07,0x03,0x06};
static const unsigned char image_Battery_controller_bits[] = {0xf8,0xff,0xff,0x01,0x04,0x00,0x00,0x02,0x07,0x00,0x00,0x02,0x05,0x00,0x00,0x02,0x05,0x00,0x00,0x02,0x07,0x00,0x00,0x02,0x04,0x00,0x00,0x02,0xf8,0xff,0xff,0x01};
static const unsigned char image_cross_contour_bits[] = {0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x01,0x8a,0x02,0x51,0x04,0x22,0x02,0x04,0x01,0x88,0x00,0x04,0x01,0x22,0x02,0x51,0x04,0x8a,0x02,0x04,0x01,0x00,0x00,0x00,0x00};
//Variables
int gaz_ramp_y = 0;
int gaz_ramp_height = 0;

void screen_setup(){
  u8g2.begin();
}
void screen_loop(){
  u8g2.firstPage();
  do{
    gaz_ramp_y = map(
      data.gaz_lecture,
      0, 4095,
      63, 11
    );
    gaz_ramp_height = map(
      data.gaz_lecture,
      0, 4095,
      2, 51
    );
    u8g2.clearBuffer();
    u8g2.setFontMode(1);
    u8g2.setBitmapMode(1);
    u8g2.drawFrame(120, 9, 6, 55);
    u8g2.drawBox(122, gaz_ramp_y, 2, gaz_ramp_height); //progress
    u8g2.setFont(u8g2_font_4x6_tr);
    u8g2.drawStr(116, 8, "Gaz");
    u8g2.setFont(u8g2_font_helvB08_tr);
    u8g2.drawStr(72, 40, "m/s");
    //Serial.println(connected_to_peer);
    if(connected_to_peer==true){
      u8g2.drawXBM(2, 2, 15, 16, image_connected_bits);
    }
    else if (connected_to_peer==false){
      u8g2.drawXBM(4, 1, 11, 16, image_cross_contour_bits);
    }
    u8g2.setFont(u8g2_font_profont29_tr);
    u8g2.drawStr(37, 46, "00");
    u8g2.drawXBM(2, 46, 19, 16, image_car_bits);
    u8g2.setFont(u8g2_font_5x8_tr);
    u8g2.drawStr(20, 8, "TRIAMPH");
    u8g2.drawXBM(25, 9, 26, 8, image_Battery_triamph_bits);
    u8g2.drawXBM(105, 54, 11, 8, image_GameMode_bits);
    u8g2.drawStr(77, 8, "CONTROL");
    u8g2.drawXBM(80, 9, 26, 8, image_Battery_controller_bits);
    u8g2.sendBuffer();
  }while(u8g2.nextPage());
  vTaskDelay(10 / portTICK_PERIOD_MS);
}